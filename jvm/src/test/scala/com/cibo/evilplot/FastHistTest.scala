/*
 * Copyright (c) 2018, CiBO Technologies, Inc.
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without modification,
 * are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this
 *    list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 *    this list of conditions and the following disclaimer in the documentation
 *    and/or other materials provided with the distribution.
 *
 * 3. Neither the name of the copyright holder nor the names of its contributors
 *    may be used to endorse or promote products derived from this software without
 *    specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR
 * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON
 * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

package com.cibo.evilplot.demo

import com.cibo.evilplot.colors._
import com.cibo.evilplot.geometry._
import com.cibo.evilplot.numeric._
import com.cibo.evilplot.{geometry, plot}
import com.cibo.evilplot.plot._
import com.cibo.evilplot.plot.aesthetics.DefaultTheme.{DefaultFonts, DefaultTheme}
import com.cibo.evilplot.plot.aesthetics.Theme
import com.cibo.evilplot.plot.components.{Legend, Marker, Position}
import com.cibo.evilplot.plot.renderers._

import scala.util.Random

object FastHistTest extends App{

  // val data = (0.0 to 3 by .25) ++ (3.0 to 5 by .05) ++ (5.0 to 8 by 1.0)


  implicit val theme: Theme = DefaultTheme.copy(
    fonts = DefaultFonts
      .copy(tickLabelSize = 14, legendLabelSize = 14, fontFace = "'Lato', sans-serif")
  )


  // val render = Histogram(data)//, 20)
  //   .standard()
  //   // .xbounds(-75, 225)
  //   // .ybounds(0, 15)
  //   // .vline(3.5, HTMLNamedColors.blue)
  //   .render(plotAreaSize)


  val plotAreaSize: Extent = Extent(1000, 600)

  def hist(data:Seq[Double], bins:Int, label:String):Unit = {

    val histOrig = Histogram(data,bins)
    val histBinned = BinnedPlot.continuous[Double](  // creates a histogram
                      data,
                      _.continuousBins(identity, bins)
                    )(_.histogram())

    List('orig -> histOrig, 'binned-> histBinned) foreach {case (k,v) => 
      // val render = histOrig.standard().xbounds(0,7)/*.ybounds(0, data.size)*/.render(plotAreaSize)
      val render = histOrig.standard().xbounds(2,7)/*.ybounds(0, data.size)*/.render(plotAreaSize)
      val file = new java.io.File(s"FastTest-${k.name}-$label-${bins}bins.png")
      render.write(file)
    }

  }


  // -- bugs
  // [x] 1. binning edge case        
  // [x] 2. standard breaks the edge cases???
  // [x] 3. ybounds is related to all this
  //     Its is all broken because the view bounds if filtering the data that is binned.  This shouldn't be possible.
  // [x]   lets try Chris's to see if it fails under the same problems
  // [x]  Chris has the same problem
  //
  // -- first fix
  // [x]  the fix should be deconflate plot range and data range (hard when both are auto too)
  // [x]  1. do the binning first
  // [x]  2. do the *viewing* NOT filtering data for binning
  // [x]  3. validate that the axis are correct.  maybe the shape and clipping are fixed in aaron and bill's hack but axis is off
  //
  // --remaining bugs
  // [x] should we clip histogram boxes by the view?
  // [-] y-axis tick marks are not on the top level overlay Position (probably Position.Left)
  // --remaining features
  // [x] implement plot ctx separate for original histogram function
  // [ ] hashed tests

  //---
  //
  val data = 1d to 10d by 1d
  val moreData = Seq.fill(10)(data).flatten
  hist(moreData, 2, "1-10")
  hist(moreData, 5, "1-10")

  val uniform = Seq.fill(10000)(Random.nextDouble()*10)
  hist(uniform, 5, "uniform")

  val normal = Seq.fill(10000)(Random.nextGaussian()*10)
  hist(normal, 5, "normal")

  val normal2 = Seq.fill(10000)(Random.nextGaussian()*1 + 4)
  hist(normal2, 50, "normal2")

  {
    //engine
    // val data = "1.8  3.2  2.8  2.8  3.5  2.2  3.8  5.7  3.8  4.9  4.6  2.2  2.2  3.4  2.2  3.8  4.3  5.0  5.7  3.3  3.0  3.3  1.5  2.2  2.5  3.0  2.5  3.0  1.5  3.5  1.3  1.8  2.3  2.3  2.0  3.0  3.0  4.6  1.0  1.6  2.3  1.5  2.2  1.5  1.8  1.5  2.0  4.5  3.0  3.0  3.8  4.6  1.6  1.8  2.5  3.0  1.3  2.3  3.2  1.6  3.8  1.5  3.0  1.6  2.4  3.0  3.0  2.3  2.2  3.8  3.8  1.8  1.6  2.0  3.4  3.4  3.8  2.1  1.9  1.2  1.8  2.2  1.3  1.5  2.2  2.2  2.4  1.8  2.5  2.0  2.8  2.3  2.4".split("\\s+").map{_.toDouble}

   val data = Vector(10.7623, 12.0795, 12.7644, 14.7594, 13.8124, 13.2061, 13.565, 11.6117, 11.4859, 15.8237, 12.9035, 10.9534, 13.2994, 12.8737, 16.7552, 16.8751, 18.634, 22.9512, 22.1749, 24.8196, 21.2501, 19.6378, 21.8393, 20.7716, 20.5295, 19.9066, 23.2877, 25.1083, 24.5475, 24.6758, 24.8316, 22.7065, 26.2087, 27.209, 29.8217, 31.312, 29.7918, 26.546, 26.464, 28.0684, 29.3695, 29.0666, 29.2769, 27.9273, 24.9161, 25.5383, 28.0077, 27.3214, 26.2495, 21.2167, 22.6509, 19.6297, 17.9695, 17.0477, 19.3319, 23.6679, 23.9827, 25.376, 25.9474, 25.8759, 23.9927, 22.3884, 24.3141, 24.8876, 23.1184, 20.5236, 21.1166, 19.4547, 18.8106, 19.7858, 18.0557, 19.3417, 19.9299, 21.7934, 20.7076, 19.7548, 20.5744, 21.1983, 21.9717, 22.0885, 26.4201, 22.8991, 21.3658, 21.2708, 21.801, 23.106, 24.9922, 24.8239, 25.2968, 19.267, 21.1649, 20.5167, 23.1216, 23.2298, 22.9096, 22.3588, 20.2962, 21.6258, 22.9028, 23.0286, 25.2366, 23.8329, 26.9978, 31.3595, 31.3487, 31.6256, 32.6502, 35.2113, 32.7679, 29.8179, 24.7777, 26.0208, 30.2997, 34.8532, 34.1431, 33.8191, 34.4554, 34.4232, 34.5485, 36.0285, 34.9008, 33.9557, 34.4625, 33.53, 31.293, 30.1629, 29.1409, 28.0298, 28.3135, 27.6129, 31.6403, 32.0552, 28.9934, 30.3977, 30.2182, 28.7639, 30.5931, 30.0982, 28.0491, 28.2199, 26.1302, 29.5637, 27.3695, 26.4313, 27.5681, 29.3954, 27.9332, 31.3146, 33.5233, 34.4131, 33.025, 31.6095, 35.7747, 37.1396, 37.1842, 36.0219, 37.8343, 34.9303, 36.4313, 36.5186, 37.0821, 38.0325, 38.471, 38.6837, 40.139, 39.4067, 41.4544, 42.9165, 44.7854, 43.1922, 44.7687, 46.3742, 46.1279, 45.0317, 46.2648, 47.2463, 51.0823, 49.188, 50.5716, 50.3908, 49.3447, 50.0127, 47.9936, 50.7216, 49.5284, 51.6529, 51.1344, 51.8909, 51.2219, 51.3557, 52.1946, 52.1672, 48.4717, 49.5281, 46.8946, 46.3441, 44.8671, 43.5584, 44.9222, 43.4108, 45.0543, 46.1544, 45.8711, 44.0152, 44.1102, 45.4246, 48.5568, 50.56, 50.5463, 49.9784, 51.9516, 53.2624, 50.3778, 49.5625, 49.8823, 49.951, 51.1856, 49.0767, 51.3153, 49.73, 48.537, 48.0783, 47.4383, 50.7566, 48.3695, 46.711, 48.3182, 49.0026, 49.104, 49.7139, 48.4113, 50.6191, 51.8655, 55.5571, 54.5759, 55.1359, 54.698, 53.7993, 54.8265, 54.6411, 52.7762, 53.5286, 55.1836, 56.4828, 55.0013, 52.7941, 53.3349, 51.579, 51.3435, 51.7135, 49.5172, 49.7066, 48.9007, 47.9373, 46.6168, 47.9973, 48.2796, 48.4021, 49.1708, 48.241, 52.5047, 54.4997, 54.8125, 55.6929, 54.7248, 51.5398, 50.7004, 46.9555, 48.8822, 48.385, 50.0345, 49.1047, 50.3298, 50.4435, 51.8371, 48.5977, 49.7968, 45.3704, 47.1415, 48.0297, 48.4666, 48.6658, 50.3379, 53.3459, 52.3835, 49.4125, 48.5227, 48.8975, 48.4154, 49.3998, 49.2058, 47.5098, 48.1285, 50.0266, 47.343, 48.2422, 46.6031, 47.3131, 47.3357, 50.5326, 51.6764, 48.5788, 49.5367, 48.896, 48.6016, 48.4477, 48.3891, 47.5237, 47.7147, 48.2041, 46.1927, 47.1524, 47.8928, 47.1373, 48.7777, 50.4144, 49.975, 48.2606, 47.4545, 48.6177, 49.0363, 51.8088, 54.3098, 53.3577, 49.8466, 48.5245, 48.6594, 46.6579, 45.9728, 44.5855, 44.3316, 43.5017, 43.2052, 41.3873, 39.0796, 38.1691, 39.8371, 40.7301, 41.9393, 42.8721, 43.3774, 42.0132, 40.7032, 40.4961, 40.9144, 41.1909, 41.347, 40.2228, 39.6643, 40.1578, 38.3825, 35.4103, 36.2227, 34.6098, 33.9378, 34.5562, 34.4116, 35.8914, 36.4533, 37.5703, 37.7474, 39.1536, 37.3777, 36.5147, 35.9722, 36.6432, 39.6036, 38.6395, 37.4364, 37.5833, 34.9687, 35.5965, 36.129, 37.7859, 38.6005, 39.1542, 41.6697, 41.3717, 39.2199, 36.1929, 36.5497, 38.7747, 40.0576, 39.0151, 41.2773, 42.1564, 42.0296, 41.1532, 41.8679, 41.5794, 40.5806, 41.4029, 35.4528, 33.8975, 33.7726, 34.7262, 34.2596, 33.4503, 35.8411, 33.8423, 35.6912, 39.0938, 39.7806, 44.2907, 42.6425, 42.9704, 40.5095, 39.8563, 43.7073, 44.7139, 47.0988, 48.3536, 49.1307, 53.6305, 53.735, 52.6796, 52.7716, 54.4675, 56.7465, 54.6413, 56.6609, 59.2717, 60.358, 60.5353, 61.4139, 60.9656, 62.908, 63.0057, 61.5917, 60.1484, 61.7993, 58.1981, 55.1061, 55.9956, 57.3575, 57.596, 61.3795, 65.386, 66.0105, 66.1354, 66.7455, 65.7946, 63.0626, 63.1145, 62.1541, 61.163, 61.9503, 63.0327, 66.6477, 66.3597, 64.7576, 63.5282, 64.4562, 67.2939, 68.0937, 69.9088, 71.5499, 70.5734, 73.0075, 73.3297, 72.6391, 73.5109, 73.6956, 73.4312, 77.1045, 76.0887, 76.6724, 78.2271, 77.2976, 76.4332, 77.6715, 79.7112, 78.8187, 79.6069, 77.8113, 81.2357, 81.9277, 80.7985, 80.722, 81.2766, 82.8533, 82.0249, 81.9248, 79.8707, 79.5528, 81.0383, 80.0057, 81.2773, 81.1142, 77.8311, 74.8826, 74.021, 74.9079, 72.4853, 72.3776, 71.2344, 70.6934, 70.8165, 73.1468, 73.2391, 73.6111, 70.3668, 67.4137, 66.219, 66.6469, 67.0328, 66.9854, 65.8558, 63.9401, 65.0178, 61.6555, 60.2069, 60.5632, 58.8801, 58.4005, 57.3217, 55.4924, 55.4474, 55.717, 56.5022, 55.6528, 54.6317, 56.4665, 51.8536, 51.8752, 49.7744, 47.1136, 49.0128, 46.2302, 44.8582, 44.5891, 42.6539, 40.718, 38.8768, 38.7948, 39.0921, 37.7226, 36.6948, 37.17, 37.498, 36.7575, 36.0664, 36.1234, 37.5616, 39.1934, 43.1704, 44.672, 45.5784, 42.0904, 46.0521, 45.1029, 45.9481, 44.0662, 41.8885, 41.5978, 41.2747, 39.3076, 39.6741, 39.2692, 40.932, 39.9232, 41.3056, 44.754, 44.5541, 46.624, 46.4481, 44.6196, 43.7882, 44.4937, 43.1957, 41.3809, 44.014, 40.6335, 40.4514, 40.9111, 40.6953, 41.1037, 40.8017, 45.194, 43.9145, 43.9308, 44.4116, 47.1021, 45.768, 46.1657, 43.8439, 44.2669, 44.3326, 43.3364, 44.8018, 46.4619, 46.4796, 45.0345, 45.0413, 44.5412, 46.4154, 45.3983, 46.4435, 46.0037, 44.2203, 43.6022, 42.824, 42.787, 43.4231, 41.9573, 44.1951, 41.0604, 44.1989, 42.7684, 44.8281, 45.1691, 44.619, 42.1969, 40.6382, 38.4927, 38.8312, 37.2828, 38.4108, 36.9033, 38.2156, 37.279, 39.3484, 39.357, 39.4448, 37.1301, 36.2381, 29.4013, 29.2061, 30.9109, 31.1213, 29.0845, 29.3655, 31.689, 34.1066, 32.3762, 32.7853, 29.9264, 26.8017, 26.1665, 25.8604, 28.7691, 28.2666, 27.9012, 31.5804, 29.2479, 29.3218, 31.0883, 29.6362, 29.278, 27.6266, 25.7707, 24.4186, 26.1332, 23.9121, 24.5282, 22.5788, 21.2022, 22.196, 21.7549, 21.3873, 20.5772, 19.9854, 23.6227, 25.6452, 25.4155, 24.8886, 26.5019, 26.8328, 26.663, 29.9197, 30.2688, 30.4035, 29.4523, 29.4636, 29.4224, 32.4254, 31.9562, 33.4095, 33.1106, 33.8103, 35.5734, 38.2011, 38.5435, 41.9415, 41.4394, 42.0832, 39.1758, 37.0075, 38.8872, 41.1351, 45.5709, 44.8789, 47.8726, 46.1004, 46.8844, 46.6674, 46.4341, 47.2878, 48.5945, 48.9335, 48.0895, 47.4819, 47.4368, 47.3886, 47.0409, 44.648, 44.5494, 42.8942, 43.6781, 44.1174, 46.5555, 49.2162, 52.988, 49.9266, 50.0029, 48.9484, 53.2798, 53.5287, 52.9076, 51.7213, 47.9915, 49.5287, 51.3883, 53.7668, 51.3851, 52.1608, 52.0731, 50.3228, 50.6626, 50.5054, 51.8953, 53.8881, 54.7927, 51.6089, 51.9093, 51.8857, 48.135, 47.0119, 46.5914, 45.631, 45.9782, 47.5484, 47.0531, 46.3853, 44.3404, 45.4351, 47.7328, 48.0029, 47.9315, 48.1395, 48.1516, 49.2489, 49.361, 53.4636, 53.293, 55.0274, 55.7729, 54.1665, 54.7905, 53.9422, 55.9513, 56.7073, 54.4407, 53.8827, 53.4673, 52.1025, 53.415, 56.2575, 58.8855, 58.787, 59.9166, 57.7211, 57.1873, 58.1795, 60.3445, 62.3521, 62.9562, 61.6441, 60.5845, 61.3289, 58.693, 58.3587, 56.4193, 57.3268, 56.0994, 57.7508, 55.2619, 54.562, 56.081, 53.603, 53.9956, 53.651, 56.4665, 56.0764, 58.0882, 58.198, 58.1935, 56.7275, 55.7534, 54.1513, 57.6855, 57.8287, 58.1051, 57.9677, 58.001, 58.3057, 57.5607, 58.2383, 58.0206, 57.4813, 57.214, 57.3743, 57.4032, 57.938, 57.5364, 60.8725, 60.3113, 63.1913, 63.2406, 63.9128, 62.6107, 64.1918, 65.3154, 64.0511, 63.1419, 61.3726, 58.1474, 59.7885, 59.4774, 58.5225, 57.9842, 58.2822, 57.163, 55.7086, 54.5358, 55.4997, 57.487, 58.5567, 60.1423, 59.117, 58.531, 59.7672, 60.9886, 61.2809, 62.1317, 61.198, 62.2353, 62.004, 61.6345, 62.9002, 63.3791, 62.233, 64.6244, 62.0443, 59.9657, 55.7579, 54.811, 54.5188, 54.1147, 55.0605, 51.9845, 49.9513, 52.4545, 52.4045, 52.7114, 55.0843, 54.0835, 54.1227, 53.8428, 51.5108, 50.5333, 49.1787, 46.4066, 45.6491, 49.2575, 48.6642, 48.6854, 49.2598, 48.6511, 50.0214, 49.4044, 50.3275, 49.7956, 51.1658, 49.9425, 51.0652, 52.115, 50.0988, 47.9392, 48.3092, 49.8679, 49.9825, 51.8, 52.0471, 54.1997, 54.0319, 52.8215, 51.8822, 50.3549, 47.9571, 50.1222, 49.1335, 49.5421, 46.5052, 47.9464, 42.7942, 42.4563, 42.5087, 43.3327, 45.655, 43.4355, 48.3839, 46.9466, 49.9837, 48.9973, 52.4739, 53.5061, 50.3772, 50.3373, 50.6863, 48.5658, 45.7596, 47.5674, 47.8, 48.581, 50.3151, 50.3846, 50.4785, 51.095, 51.6473, 51.5653, 48.7591, 48.3062, 47.7588, 50.6759, 49.5615, 50.1147, 51.6044, 51.5911, 51.1624, 49.9953, 51.0618, 50.8607, 51.4741, 51.073, 52.3629, 52.4956, 51.2684, 49.2225, 49.0435, 50.7679, 53.6924, 49.2314, 47.196, 44.361, 44.2678, 44.9422, 44.9918, 44.9566, 42.8699, 41.7936, 42.568, 44.1161, 43.6633, 45.5663, 47.7801, 49.569, 48.0808, 47.1986, 46.28, 43.3551, 41.9317, 42.2942, 44.3266, 45.5133, 44.9744, 45.2713, 43.1066, 42.5316, 42.4277, 42.8244, 43.2784, 43.1878, 41.3797, 38.1674, 39.1341, 37.08, 35.9931, 36.1438, 37.7919, 36.4312, 38.1405, 38.0624, 36.9257, 38.2018, 37.5793, 39.615, 38.6826, 37.1062, 34.9837, 0.62489, 0.859683, 1.79665, 2.31416, 1.75952, 2.38663, 3.12436, 3.27841, 1.77693, 1.46964, 1.47853, 1.28729, 2.39599, 2.56577, 1.71149, 2.41897, 1.80245, 2.31137, 3.10659, 4.59441, 4.43741, 4.03854, 4.08966, 3.93475, 4.36185, 3.34328, 3.86038, 4.47041, 3.13191, 3.01197, 0.912041, 0.595437, -0.190399, -0.0288253, 0.0821007, 0.954715, 1.49879, 1.23626, 0.411385, 0.0772101, 0.722044, 0.471646, 1.5609, 2.4288, 2.44286, 2.86727, 3.49614, 3.67671, 4.1437, 4.29234, 3.62091, 4.45889, 4.0729, 4.23868, 4.44536, 6.34884, 6.21714, 7.65826, 8.3293, 8.3989, 9.21504, 9.17868, 8.21304, 10.0043, 10.7582, 10.5272, 10.0151, 9.66187, 10.2872, 9.87086, 8.8311, 9.86417, 9.86618, 11.1534, 9.83884, 10.6125, 10.5961, 10.0581, 10.7238, 11.2385, 11.3238, 11.0129, 10.2758, 10.8319, 11.5803, 12.9493, 13.5419, 12.3952, 13.4864, 13.4494, 13.2123, 13.9848, 14.415, 14.5846, 14.2585, 16.4229, 16.2, 15.6619, 16.133, 15.0603, 15.7989, 15.7449, 16.003, 16.1862, 16.7693, 16.8471, 15.4856, 16.0668, 14.983, 15.3467, 14.9521, 17.0442, 16.3128, 15.7189, 15.9043, 16.221, 16.3821, 15.7389, 15.8401, 15.8474, 15.8125, 17.2343, 17.2855, 17.6718, 17.9428, 18.2348, 18.7628, 17.3495, 19.0027, 18.7854, 18.3785, 18.4456, 18.6073, 19.094, 19.0748, 19.3996, 20.777, 20.5109, 20.0728, 20.5218, 21.2638, 21.6737, 22.167, 20.7022, 20.5851, 20.6018, 19.7839, 20.469, 20.4656, 20.5728, 20.634, 20.5338, 21.174, 20.8386, 22.0903, 21.3175, 20.9434, 20.6632, 20.0867, 19.6612, 18.9326, 18.6918, 18.8935, 18.6238, 18.0081, 19.7567, 20.2132, 21.1946, 20.7921, 20.2238, 19.3574, 19.3728, 19.8332, 20.6054, 20.573, 20.3678, 20.6399, 21.4011, 20.811, 20.4246, 20.5528, 21.201, 19.3423, 19.3422, 19.6338, 18.7852, 19.3872, 19.7022, 20.5185, 19.8496, 19.048, 19.4048, 18.4919, 18.5226, 17.8161, 17.4391, 17.3723, 17.3933, 17.1248, 18.7338, 19.3715, 20.3229, 18.9586, 20.66, 20.307, 20.7387, 20.6691, 21.2641, 21.7289, 21.4217, 22.0795, 21.6168, 20.4631, 19.9588, 18.9427, 19.0978, 20.034, 20.4126, 21.0686, 20.7831, 21.6009, 21.3854, 21.9996, 21.5335, 21.7714, 21.9931, 22.4218, 22.5136, 23.7282, 23.535, 23.5525, 25.3685, 25.2975, 26.8619, 26.3347, 25.4743, 24.7564, 24.3903, 23.1284, 24.2557, 24.1675, 25.3455, 25.6931, 26.2623, 27.5875, 27.1709, 27.4008, 28.0931, 27.1181, 27.1673, 28.2639, 28.5725, 28.5212, 28.7738, 28.204, 28.533, 28.053, 28.6502, 28.9817, 28.1922, 28.9216, 27.9473, 27.8324, 27.3657, 27.1801, 26.2246, 25.5495, 25.3349, 26.2911, 26.7731, 26.2018, 25.7207, 25.1679, 25.5719, 24.2054, 25.4732, 25.6661, 26.7899, 25.9093, 25.2703, 24.9832, 24.9595, 25.2731, 25.2486, 25.8949, 25.5487, 26.7075, 27.9929, 28.7092, 28.9978, 27.9264, 27.437, 26.889, 26.6107, 26.7226, 26.0174, 25.6485, 26.5246, 26.4632, 26.457, 24.6279, 24.6362, 24.8607, 25.8898, 25.5784, 24.9783, 26.1383, 24.8427, 24.1044, 25.3216, 25.0037, 24.3192, 24.623, 23.7172, 24.4169, 24.8518, 23.6791, 23.5742, 24.4842, 24.6053, 23.6416, 23.2214, 23.3415, 23.6478, 24.391, 25.5191, 26.9698, 28.0178, 28.474, 28.5814, 28.6302, 28.4379, 28.8876, 29.6221, 29.284, 29.2146, 29.0549, 29.625, 30.3674, 30.5589, 29.8914, 28.6579, 28.1459, 28.187, 27.9886, 28.4775, 28.7116, 28.4546, 28.6998, 28.4986, 27.9544, 27.2896, 27.1474, 26.5013, 26.3678, 26.8118, 25.2961, 26.8184, 27.151, 28.0669, 28.2227, 28.334, 27.8479, 27.2643, 26.9737, 26.9283, 27.6498, 28.5159, 28.3973, 27.6869, 27.8338, 26.9812, 27.8017, 28.2845, 26.8386, 26.6754, 24.916, 24.6963, 24.9291, 24.8372, 24.9748, 25.0649, 24.7433, 24.5905, 24.823, 24.5544, 24.2458, 23.5509, 22.9682, 23.906, 22.61, 21.5082, 23.6192, 22.3629, 21.5133, 21.559, 21.3022, 22.0839, 22.1466, 21.6153, 21.0479, 21.5157, 21.2454, 21.584, 21.1809, 22.1852, 22.5749, 22.0916, 21.1345, 20.4958, 21.4881, 20.2383, 20.7122, 20.908, 22.1988, 21.8145, 21.7799, 21.7281, 21.7803, 21.8689, 21.3962, 21.7121, 20.7894, 20.7711, 20.5043, 20.3795, 22.1513, 22.7764, 22.5942, 21.9788, 22.7566, 22.045, 20.8532, 20.9145, 20.6822, 21.9014, 20.9329, 21.5019, 21.5315, 21.2342, 21.3723, 21.877, 22.3592, 22.0155, 22.5057, 21.9326, 21.4998, 22.617, 23.482, 22.4151, 22.087, 23.2518, 23.363, 22.845, 22.1929, 22.1952, 21.767, 21.4774, 20.9417, 21.9498, 20.8787, 20.965, 20.2023, 20.833, 21.0809, 20.7135, 21.0554, 20.6201, 20.8554, 20.5075, 20.3911, 21.1949, 21.8821, 21.8416, 20.8881, 20.1371, 20.6484, 19.9625, 18.7966, 19.3171, 19.2802, 18.2796, 18.5382, 18.4803, 18.6111, 18.9713, 19.8655, 20.2008, 19.8938, 20.5272, 20.0901, 20.1755, 20.5535, 20.0749, 19.7765, 18.9149, 19.612, 18.9367, 19.2258, 18.914, 17.8696, 17.0875, 17.4579, 18.1042, 17.7603, 17.7001, 17.9816, 19.0876, 19.5547, 21.7178, 20.4362, 20.75, 22.2018, 22.0553, 22.5739, 22.7222, 23.4684, 22.8409, 22.1914, 21.3664, 21.8001, 21.9273, 19.8419, 19.9075, 19.7376, 19.8698, 19.2581, 19.3367, 20.4439, 19.1126, 19.3181, 18.9234, 19.1912, 18.5308, 19.7431, 20.1113, 20.1159, 20.1453, 20.2754, 20.0256, 19.8664, 19.3179, 19.3638, 18.8801, 19.2435, 18.4255, 17.4922, 18.3799, 18.5988, 17.3484, 16.6215, 16.4131, 15.2022, 15.9992, 15.3342, 15.5058, 15.452, 14.7639, 15.3368, 16.5429, 15.7738, 14.4344, 14.004, 14.5936, 14.2797, 13.7743, 14.1649, 13.1688, 12.9184, 12.5373, 12.7745, 11.9844, 11.4687, 10.9266, 11.0155, 10.9097, 10.2595, 9.81778, 8.64859, 9.13177, 9.39574, 9.74016, 9.92264, 10.5273, 10.6044, 9.99238, 10.6015, 11.8999, 11.2816, 11.0914, 10.7666, 11.8557, 12.3976, 12.496, 11.8435, 12.2661, 10.9275, 10.7574, 10.6498, 11.8987, 12.6588, 12.4727, 13.5583, 11.6355, 11.9274, 11.7667, 11.0451, 10.2863, 10.8585, 12.3892, 11.7486, 10.5437, 10.2871, 10.031, 9.82948, 10.8251, 10.7097, 11.3727, 11.8475, 11.2736, 12.8146, 12.7479, 12.2198, 12.7997, 11.7395, 11.0729, 10.3543, 10.4666, 10.3228, 9.69273, 9.80764, 10.3467, 11.0019, 9.72574, 10.2884, 11.4141, 12.772, 12.2171, 11.9451, 12.3736, 12.0397, 11.3112, 13.1333, 11.4021, 11.7955, 13.6308, 13.3611, 12.8909, 12.6524, 12.1185, 11.7578, 11.7928, 12.1528, 10.8698, 10.3978, 11.3396, 10.9179, 10.6576, 11.0008, 10.5858, 10.4438, 12.1903, 11.7687, 11.5045, 12.6538, 11.9788, 11.9594, 11.9927, 13.0032, 12.1859, 11.5937, 10.8287, 10.4751, 9.83244, 11.0707, 11.6314, 12.5108, 14.0106, 13.3899, 14.6138, 13.2439, 12.319, 12.548, 11.8886, 12.412, 12.9684, 12.2111, 11.8144, 11.3437, 11.0267, 11.4377, 11.2139, 11.4649, 9.8463, 10.1567, 11.4915, 11.6756, 11.8321, 11.3643, 11.5594, 11.854, 12.3424, 11.6106, 11.583, 11.1758, 11.3129, 11.3995, 13.0667, 13.2312, 12.0956, 12.9351, 12.4994, 13.051, 12.7627, 11.6972, 11.9814, 11.345, 9.00209, 9.01099, 8.78337, 8.66401, 9.16786, 9.47822, 9.30921, 9.73283, 9.40759, 9.3755, 10.3361, 10.3718, 9.93354, 8.59079, 8.99589, 8.16232, 8.66938, 7.34907, 8.49858, 8.41064, 8.84187, 9.20116, 7.0241, 6.12287, 6.08756, 5.81797, 5.31234, 4.36592, 4.25847, 4.06824, 4.13725, 3.95287, 4.15088, 5.00471, 5.45505, 6.0245, 6.54816, 7.67464, 7.626, 7.8912, 9.52122, 8.72929, 7.3287, 7.19917, 7.60022, 8.26352, 8.28943, 7.64704, 7.13422, 7.09577, 7.27788, 8.06109, 8.16897, 8.3371, 9.93282, 11.8558, 11.3623, 11.1071, 11.8208, 11.5532, 11.1833, 10.0852, 10.2334, 10.6833, 11.4725, 11.0868, 10.5524, 10.3904, 10.2335, 12.1979, 11.7334, 11.6155, 11.9115, 12.8293, 12.6145, 11.5365, 11.7257, 12.6707, 13.7677, 12.8703, 12.2638, 12.739, 11.9236, 13.5668, 11.8616, 12.08, 11.1138, 10.3092, 11.5159, 11.5086, 10.4357, 10.3196, 10.0219, 9.26615, 8.08794, 8.03162, 8.20948, 6.42485, 6.17501, 5.71032, 5.65706, 5.81888, 5.50315, 5.12742, 5.22051, 5.05109, 4.60418, 4.16014, 3.74224, 3.90165, 3.20799, 4.16131, 4.40735, 4.56935, 4.11936, 3.75814, 3.23444, 4.26008, 4.59025, 3.82517, 3.09653, 3.07566, 3.01994, 2.73788, 1.9228, 1.87643, 2.22833, 2.03566, 1.89352, 3.06578, 2.57951, 2.67121, 2.20145, 3.45726, 2.55187, 2.37415, 3.00757, 2.82348, 2.44054, 3.68484, 3.79208, 3.97519, 4.70625, 4.67032, 4.9187, 5.89245, 5.72613, 5.22273, 3.95924, 3.48441, 3.03541, 2.8701, 2.86189, 4.16318, 5.89737, 4.92629, 4.74863, 5.79494, 4.80763, 5.30031, 4.96349, 4.21462, 2.89762, 2.84935, 1.24081, 1.87387, 2.05518, 3.1263, 2.92028, 2.83231, 2.67129, 3.65585, 3.28943, 3.44039, 4.71481, 4.53463, 4.2167, 4.35765, 4.91408, 5.71472, 5.42829, 4.96773, 4.10152, 4.81387, 4.99132, 8.38779, 7.9889, 8.11839, 9.86579, 10.1496, 9.66273, 10.298, 9.82307, 9.79237, 9.91767, 9.58715, 10.0153, 10.0613, 11.4432, 11.3881, 11.8323, 10.5682, 11.3072, 12.031, 11.9434, 12.1168, 11.1368, 11.6484, 11.9781, 11.4954, 11.323, 10.642, 11.1949, 10.7873, 10.6194, 11.3145, 10.8643, 10.2137, 9.48698, 9.89884, 9.46126, 9.25781, 9.08467, 10.0517, 9.96271, 10.4123, 9.81974, 9.39931, 9.66841, 9.52628, 10.1502, 10.4273, 8.79105, 9.55594, 10.3144, 10.2507, 10.7823, 10.3398, 9.66683, 10.5569, 11.5501, 11.5805, 12.8224, 12.0493, 12.0566, 11.5396, 10.8821, 11.837, 12.3464, 13.14, 12.5008, 14.1129, 13.2816, 13.2465, 13.0556, 13.854, 13.3894, 13.7608, 13.4957, 12.5781, 12.6449, 12.7218, 13.0622, 14.4302, 14.2232, 14.0213, 14.0109, 13.2259, 14.1623, 14.5932, 13.3795, 14.3309, 12.7518, 14.0485, 13.5778, 15.1507, 15.7358, 15.9539, 15.8453, 15.7854, 14.9593, 15.0128, 15.346, 78.047, 82.1167, 84.0664, 86.7489, 87.3542, 88.7158, 91.3096, 96.6651, 99.1241, 98.2208, 103.32, 105.188, 115.592, 112.926, 110.861, 104.752, 98.7407, 98.6496, 106.37, 101.198, 101.719, 103.334, 103.671, 105.72, 106.09, 97.235, 95.7861, 98.0212, 96.5821, 106.521, 107.09, 105.22, 104.965, 101.351, 104.308, 105.102, 109.646, 108.965, 107.514, 110.084, 103.276, 97.5519, 99.8121, 103.866, 103.72, 97.3353, 98.0351, 96.2663, 94.6448, 92.2855, 95.4628, 100.115, 99.0555, 98.2033, 98.1396, 100.415, 97.6353, 101.145, 98.7246, 98.0149, 98.4763, 99.6636, 94.4754, 94.155, 97.0489, 94.3187, 94.3325, 95.9473, 98.9604, 95.7774, 102.128, 104.649, 108.51, 101.792, 95.6485, 94.578, 96.0619, 100.818, 102.799, 103.354, 99.2783, 96.5123, 100.388, 102.636, 101.616, 101.081, 97.8945, 99.8034, 100.109, 104.309, 99.983, 101.925, 104.967, 106.866, 105.715, 107.272, 105.929, 103.809, 103.475, 108.45, 105.824, 103.473, 99.6618, 99.6827, 104.893, 105.862, 106.438, 111.273, 106.759, 110.478, 107.112, 111.952, 117.4, 119.817, 112.336, 110.052, 108.42, 104.686, 106.851, 107.243, 101.397, 98.89, 96.2838, 94.4171, 92.2545, 86.4873, 89.1584, 90.2908, 91.1331, 86.0881, 82.0456, 84.1033, 84.8366, 87.2303, 84.7518, 87.0198, 87.4963, 87.2054, 82.0294, 83.331, 85.5764, 91.1066, 94.5264, 97.1988, 92.7223, 88.8094, 85.8355, 88.5364, 92.9714, 104.516, 104.329, 102.547, 101.829, 95.8578, 95.6551, 97.311, 96.7194, 99.6374, 96.3018, 86.0575, 89.5781, 88.8325, 87.4091, 86.0111, 86.8136, 84.9191, 87.1724, 82.369, 84.2261, 81.8204, 79.3942, 79.5428, 78.6008, 80.8044, 75.2385, 75.4157, 74.0108, 78.7918, 75.2658, 74.1691, 73.5369, 77.764, 75.3662, 73.7295, 73.5528, 74.358, 77.1155, 75.3233, 72.3205, 77.4616, 77.5164, 77.302, 76.0884, 73.847, 76.9603, 80.1694, 81.6852, 90.2049, 87.1739, 86.3589, 87.851, 79.7159, 79.5943, 78.896, 79.6321, 72.1027, 72.7971, 67.4724, 65.5407, 64.3996, 65.9528, 71.3943, 75.5735, 77.083, 76.3623, 79.1074, 78.5285, 77.2514, 75.5651, 80.7575, 84.1773, 81.0186, 77.7285, 76.5266, 80.565, 73.7176, 71.4051, 78.6281, 78.2821, 76.9644, 79.3209, 76.9362, 74.2015, 76.6137, 76.3685, 83.4416, 80.7381, 81.8276, 81.1745, 80.8757, 80.9146, 76.6499, 86.6264, 81.3257, 74.0478, 72.5267, 72.0905, 73.573, 73.0797, 75.4714, 72.8055, 68.6912, 70.1155, 77.056, 79.7528, 83.4267, 73.85, 74.4375, 71.242, 73.1797, 76.007, 73.2029, 77.3284, 84.2815, 82.5843, 79.5317, 77.0207, 74.6976, 82.1662, 83.612, 78.4557, 81.4821, 80.0454, 86.0282, 81.718, 87.2063, 83.508, 80.6277, 76.1245, 75.6709, 70.7334, 72.8229, 72.595, 72.2993, 74.9979, 78.0366, 76.9189, 76.9945, 78.8121, 80.1323, 77.5305, 76.0068, 76.0412, 76.2723, 76.121, 74.3254, 74.0309, 70.7494, 72.3718, 78.4333, 81.045, 82.8916, 82.1212, 84.74, 84.1536, 82.0657, 79.4482, 81.9155, 84.9413, 86.7304, 95.3333, 92.7995, 93.7108, 87.3937, 81.6853, 81.5997, 76.5741, 76.5284, 78.2568, 76.7228, 78.478, 72.0826, 72.9561, 74.9277, 67.2115, 68.6599, 73.4872, 74.9739, 76.4139, 70.7422, 71.3262, 74.3696, 78.9558, 76.4954, 79.1917, 79.4059, 77.0248, 77.7744, 78.0754, 70.9845, 71.5073, 67.1608, 66.0895, 68.721, 72.0286, 73.4083, 76.7298, 77.8867, 82.1146, 80.4289, 81.6914, 83.1184, 80.4659, 80.7569, 78.8685, 81.9799, 75.0811, 75.975, 76.9763, 72.9406, 73.3942, 73.2453, 74.5541, 69.4609, 71.8112, 72.14, 69.464, 71.9539, 68.5772, 68.4446, 59.9607, 65.9038, 65.3022, 65.1015, 60.3627, 66.319, 71.001, 66.7704, 64.8847, 65.1297, 67.7247, 65.3326, 65.7678, 62.435, 68.3597, 63.6798, 62.8012, 66.2903, 67.6128, 63.1082, 61.1767, 58.1979, 60.0814, 55.2768, 54.733, 61.035, 58.8319, 62.5982, 56.2617, 56.3841, 56.7846, 60.0275, 63.6821, 68.5733, 64.5589, 67.3428, 64.9368, 64.6329, 66.003, 67.9551, 68.0828, 62.1172, 61.6228, 54.5061, 51.5538, 50.3829, 46.7647, 48.2094, 44.5655, 46.6941, 49.2081, 46.9767, 48.1048, 51.4693, 48.8119, 52.0608, 51.9192, 53.8679, 51.4715, 48.7178, 51.5829, 48.126, 49.042, 51.0644, 49.2682, 50.4729, 47.8242, 51.2433, 51.1653, 46.514, 45.5451, 45.1909, 43.0205, 42.445, 38.016, 35.98, 37.0876, 32.8937, 29.5735, 26.5401, 19.3774, 21.0513, 25.9964, 26.8813, 25.6049, 22.3722, 20.2705, 26.0961, 26.3316, 21.7045, 21.8519, 25.8524, 23.7217, 24.3938, 23.3732, 26.762, 28.8844, 27.1732, 26.8674, 31.1666, 32.5783, 28.5721, 32.8509, 34.874, 35.3575, 36.2524, 28.6777, 29.7193, 34.7851, 31.6472, 31.16, 33.108, 28.5628, 28.7814, 30.1024, 33.7023, 37.4143, 38.359, 36.5836, 39.6715, 33.1875, 35.3292, 41.7807, 37.539, 36.5514, 31.6456, 31.135, 32.1105, 33.3321, 35.0287, 36.117, 37.9384, 37.9016, 42.1116, 40.8122, 35.0795, 37.9653, 34.3857, 31.322, 30.5018, 34.0814, 35.3341, 32.4174, 26.9954, 27.4501, 30.3234, 34.2489, 34.2136, 33.2093, 31.5936, 30.4645, 31.4553, 29.7769, 33.95, 29.6701, 34.8958, 29.6064, 28.2345, 31.4129, 27.0084, 27.7277, 35.6826, 31.4, 27.858, 29.2185, 30.3742, 35.6216, 32.4017, 32.9521, 35.1695, 33.3514, 33.3139, 38.8966, 39.3227, 37.2446, 30.4921, 30.5583, 36.362, 33.203, 34.5628, 28.86, 28.5593, 36.07, 36.3669, 36.679, 34.0601, 36.441, 34.0673, 33.6433, 31.2944, 36.9376, 44.1452, 38.0333, 40.3554, 40.5747, 40.6511, 37.9764, 39.4564, 41.2185, 41.67, 42.3311, 37.8346, 37.0913, 37.3995, 37.5478, 37.0557, 35.5421, 34.9955, 32.0482, 35.9975, 43.0699, 48.0124, 50.7475, 49.9852, 44.5158, 53.1863, 55.0807, 53.8733, 52.995, 50.9182, 48.2435, 43.9529, 44.5485, 43.3842, 48.0478, 46.4777, 45.3049, 48.8926, 48.0162, 46.2513, 46.4428, 40.138, 40.1158, 38.9343, 37.329, 31.4988, 31.3413, 31.2277, 27.944, 23.6176, 21.644, 16.2021, 12.9254, 9.56815, 3.56978, 4.5703, 3.25126, 2.05594, 2.91579, 0.840552, 0.871004, -2.10977, -0.322098, -1.48991, -3.58897, 0.393767, -0.866343, -3.01349, -5.09886, -4.17959, -8.66853, -2.27212, 0.927384, 3.62111, -1.12729, -2.20332, -3.52209, 5.17586, 0.872653, 0.71613, 4.18254, 7.32499, 5.23257, 7.9847, 2.54911, -1.93927, 0.241485, -2.76175, -4.88233, -2.4919, -1.07175, 3.2475, 5.56602, 5.41329, 6.53925, 14.455, 10.5835, 18.135, 19.166, 22.0608, 24.3485, 28.844, 25.5429, 26.3311, 25.0142, 18.8741, 19.3997, 17.9601, 19.3464, 17.1375, 19.1343, 20.4553, 17.4612, 23.5663, 26.1508, 31.7538, 31.5604, 36.0229, 32.4553, 34.3298, 34.8982, 38.9801, 38.3676, 41.4701, 39.7247, 39.7144, 36.0869, 39.8467, 46.4716, 45.764, 47.0046, 50.7194, 51.632, 50.2539, 44.0097, 41.6657, 39.316, 37.7985, 41.4809, 41.3969, 49.6629, 51.7998, 59.7665, 58.7847, 60.7381, 58.1959, 58.2836, 56.5351, 51.1139, 50.5078, 52.7198, 46.1151, 42.4904, 39.6251, 33.1923, 40.2693, 37.4392, 31.7262, 36.4221, 36.8566, 38.1278, 45.3212, 41.6022, 46.5888, 46.2957, 47.0258, 46.9984, 46.5749, 38.879, 41.3377, 34.8734, 26.9778, 28.7984, 25.7792, 21.3911, 16.9988, 20.0504, 16.6446, 23.6431, 26.6522, 25.7104, 20.2418, 23.1883, 25.9943, 26.2845, 24.7623, 29.1268, 28.8895, 31.6157, 27.0023, 26.1509, 19.3778, 20.75, 18.7171, 13.8669, 15.4217, 17.8707, 18.9271, 25.6839, 19.9052, 19.071, 21.2958, 18.5386, 21.8656, 22.3408, 25.1734, 26.5573, 28.0927, 26.3916, 31.7999, 31.4598, 29.7298, 23.4103, 27.4453, 24.4115, 21.8647, 26.5721, 26.9661, 23.3457, 17.7971, 23.5942, 22.7245, 20.7359, 18.8788, 12.2229, 12.521, 15.664, 17.1101, 20.2571, 16.3573, 18.1028, 20.075, 17.7126, 15.8631, 13.61, 14.1685, 9.03479, 3.44034, 5.42574, 9.12479, 7.69274, 5.15572, 10.9921, 13.1013, 12.2, 10.0459, 13.0051, 12.9216, 16.8239, 20.4526, 17.5686, 17.7159, 15.8717, 16.7293, 16.5533, 19.0776, 23.1678, 22.5516, 22.0744, 23.6882, 21.2824, 19.3537, 20.122, 23.6333, 23.1126, 21.6377, 16.3319, 14.5592, 13.3337, 12.4425, 13.0133, 11.2515, 13.0272, 15.0432, 20.5913, 19.9048, 17.914, 16.187, 17.1692, 19.1203, 16.1875, 15.4681, 17.6516, 20.4715, 21.5441, 25.5189, 27.9667, 24.8529, 27.3741, 28.1051, 39.1102, 35.1813, 34.0293, 35.1744, 35.5109, 36.0123, 36.1584, 38.5015, 32.3666, 40.7559, 37.1843, 39.3254, 43.3209, 46.7186, 46.822, 50.0232, 44.4269, 46.1316, 45.5651, 45.0514, 41.5383, 33.4076, 32.4275, 34.3592, 32.4495, 35.5166, 33.1864, 33.561, 36.6427, 40.9713, 47.2216, 49.1301, 39.5149, 34.7787, 36.2723, 31.5892, 33.5812, 36.6216, 37.7604, 32.6074, 33.9075, 35.282, 38.5827, 44.1362, 45.7918, 48.406, 44.1815, 40.7196, 46.1808, 45.5607, 47.3879, 49.0283, 51.9077, 46.8475, 45.8612, 42.4242, 41.908, 43.2793, 44.9747, 42.3605, 42.0163, 40.9948, 40.6199, 46.2729, 46.9054, 45.5045, 47.3146, 50.2091, 54.4082, 53.1758, 45.2056, 49.7582, 50.3996, 55.1788, 53.4037, 53.1351, 52.4976, 55.627, 55.8124, 60.0066, 62.0544, 58.8761, 58.5605, 59.9612, 58.3207, 55.2587, 57.9586, 61.7009, 63.04, 63.0498, 63.3054, 66.5962, 67.5788, 68.2115, 69.5037, 73.3014, 71.9112, 74.9752, 75.1048, 69.9542, 73.0635, 74.0379, 70.4441, 73.5378, 72.856, 73.5174, 72.128, 74.0081, 75.0287, 73.0178, 75.5262, 73.1566, 71.5596, 73.5103, 72.0042, 71.9079, 66.8868, 65.5691, 64.2488, 71.3122, 72.0266, 71.9455, 74.9989, 75.7957, 78.0761, 81.4226, 87.6995, 85.8467, 86.8713, 85.0373, 82.3069, 85.3001, 86.4917, 79.3646, 83.6827, 84.7541, 86.3291, 88.2872, 88.9414, 86.0372, 89.2198, 84.7461, 92.7842, 90.5641, 85.869, 86.7215, 86.9656, 81.1659, 75.0175, 69.2014, 2.08397, 2.44112, 3.23167, 5.17531, 5.48523, 6.91717, 6.55418, 6.39488, 7.71787, 7.76312, 9.30152, 8.19931, 8.66375, 9.19952, 10.7352, 11.0136, 10.9796, 10.3241, 11.514, 12.6663, 14.8271, 17.5761, 17.4696, 17.0059, 18.0086, 18.6707, 19.5458, 18.6481, 20.957, 20.8586, 21.4389, 21.0138, 22.0307, 22.1204, 23.2356, 23.6094, 22.9763, 22.8101, 22.1234, 19.4352, 19.407, 19.9837, 18.7593, 20.182, 19.7956, 19.5963, 18.7938, 19.0842, 18.4855, 15.8415, 14.9356, 15.5312, 17.7202, 17.3064, 17.8187, 17.7497, 19.4318, 19.0398, 18.7749, 19.8658, 19.5614, 18.8853, 19.373, 19.0818, 20.0882, 20.2285, 20.7674, 20.398, 20.479, 20.0773, 20.5047, 20.6794, 21.4767, 22.5164, 23.3414, 24.5064, 24.8469, 24.9575, 25.5718, 24.8692, 25.4216, 24.9886, 26.9244, 26.7522, 27.0107, 27.5107, 27.9619, 26.8567, 27.1279, 27.0836, 28.5652, 28.4317, 30.2874, 29.8831, 31.2588, 31.9013, 32.4286, 32.381, 31.5331, 30.6298, 30.135, 29.4448, 29.9481, 29.74, 31.6013, 30.7405, 30.2473, 31.9553, 32.6639, 33.2833, 34.5038, 34.7699, 33.8976, 32.8019, 32.7263, 32.7911, 34.6031, 32.8102, 32.1982, 32.6639, 34.6693, 33.4871, 34.4385, 33.8063, 32.0851, 31.222, 30.954, 31.9662, 32.8409, 32.3944, 32.3119, 32.132, 31.6648, 32.6064, 31.4577, 31.519, 31.644, 32.0456, 31.773, 31.0556, 31.4278, 31.6885, 32.9586, 32.0058, 31.7341, 32.7397, 32.9508, 33.1082, 33.1217, 34.0583, 32.2247, 31.5762, 31.4625, 33.3278, 33.5853, 33.3624, 34.2003, 36.0566, 35.4939, 35.0955, 34.3374, 34.5928, 35.967, 35.2372, 35.8509, 35.4156, 34.3947, 35.3231, 35.9525, 35.4972, 35.3066, 35.8004, 35.818, 35.8794, 35.7808, 36.2058, 36.3369, 35.6773, 35.5611, 34.9252, 34.785, 35.6569, 35.4811, 34.5007, 34.2207, 35.7178, 36.1985, 36.0038, 37.1942, 37.2331, 36.9877, 37.5013, 36.5882, 37.3367, 35.7318, 36.6545, 36.148, 35.8473, 36.7084, 37.8948, 37.9718, 37.7947, 37.1926, 36.9724, 36.6304, 37.5138, 37.2928, 37.7066, 36.0852, 36.0207, 36.6837, 36.9747, 37.2258, 38.3799, 39.0749, 38.7556, 39.1057, 38.5471, 37.3959, 38.3961, 38.2795, 37.9724, 37.8475, 38.7607, 39.304, 38.6607, 39.2931, 39.0105, 37.1749, 36.3611, 38.0426, 37.7928, 37.9524, 36.5458, 36.8378, 36.3048, 39.0126, 37.2116, 37.8645, 38.9792, 38.7011, 38.5408, 38.3779, 41.14, 41.6335, 42.4406, 43.2663, 43.5109, 43.2923, 43.915, 43.9401, 45.5249, 46.053, 45.2352, 45.4734, 44.55, 44.7731, 43.8626, 43.2317, 42.7333, 42.9022, 42.9269, 42.2598, 41.6032, 41.0503, 42.1211, 44.1354, 45.0038, 43.3298, 44.3613, 42.5289, 42.0264, 43.0494, 43.2454, 42.5151, 41.8833, 43.47, 43.815, 43.0966, 41.8912, 42.8169, 43.5841, 44.8932, 43.3432, 43.1387, 41.9146, 42.1541, 40.4931, 41.2518, 41.3682, 40.9993, 41.3933, 41.8381, 41.598, 39.8138, 39.6364, 40.0403, 39.8471, 40.7355, 40.2597, 39.474, 38.8174, 38.4308, 37.5215, 37.0525, 37.9913, 37.8978, 37.4391, 37.0841, 35.6829, 34.9478, 34.075, 35.3664, 37.0496, 37.4976, 37.9888, 38.2319, 40.1795, 39.8799, 40.8312, 41.6563, 40.9806, 41.7566, 41.0822, 41.3738, 41.1937, 42.0699, 43.6344, 43.5103, 43.8398, 43.6981, 44.3751, 43.5498, 44.6112, 44.0061, 43.8159, 42.095, 42.4794, 42.6492, 42.8466, 43.0258, 43.6383, 44.2435, 45.1837, 46.025, 46.1874, 47.2439, 46.888, 47.4935, 47.7877, 47.2925, 47.5801, 48.0748, 48.3444, 48.9311, 48.414, 48.5689, 49.2726, 50.1024, 50.0267, 50.1252, 48.2409, 45.1033, 44.7771, 44.982, 45.9154, 44.9933, 41.4278, 41.9189, 41.2923, 40.3293, 38.8388, 38.095, 37.8147, 37.9315, 39.2789, 40.1878, 41.0384, 40.3153, 40.8007, 40.4608, 41.1486, 41.5166, 42.3236, 42.8174, 43.9444, 44.0702, 44.3855, 44.0364, 44.2471, 45.6467, 46.4003, 44.8357, 45.4958, 48.6099, 47.3747, 46.9765, 47.7919, 47.4128, 47.3907, 47.7052, 48.0004, 48.7165, 48.7813, 48.9489, 49.1313, 48.6604, 48.7067, 48.687, 49.3201, 50.3882, 50.5127, 51.0624, 50.9118, 50.8663, 52.571, 53.4082, 53.0174, 54.3082, 54.3519, 53.6452, 55.2297, 54.8685, 54.8476, 55.7581, 55.4172, 53.9417, 53.3227, 52.2517, 53.0563, 52.7629, 51.9395, 50.7343, 52.3737, 52.616, 51.3691, 51.0848, 51.0943, 50.0705, 49.0363, 49.8549, 50.1167, 49.6351, 49.0636, 50.4129, 50.5395, 49.4634, 50.7946, 51.0623, 50.9897, 50.6124, 50.5504, 52.4529, 51.904, 52.627, 53.6949, 55.1581, 54.9403, 56.3842, 56.7537, 57.5043, 57.855, 57.8063, 58.1698, 55.5301, 56.1507, 54.329, 54.8116, 53.8281, 53.9671, 53.913, 54.7321, 53.3976, 54.0245, 54.3182, 54.8749, 55.0549, 55.5012, 54.5718, 54.0959, 54.5163, 54.2132, 54.9523, 54.6989, 53.6167, 54.3407, 55.2868, 55.3895, 55.9742, 54.9279, 54.5174, 53.7519, 52.6677, 52.777, 55.8377, 55.9936, 56.6783, 56.8597, 56.9207, 55.2905, 53.4675, 52.2893, 53.1835, 53.495, 53.6901, 54.5452, 54.4078, 56.2772, 56.3495, 55.3804, 55.2217, 55.7333, 54.8789, 54.3094, 55.7901, 54.8111, 54.1942, 54.5858, 55.0623, 55.7968, 55.9072, 56.0981, 56.4028, 53.9196, 53.9909, 53.6211, 55.6385, 56.9216, 57.7712, 57.681, 57.6531, 56.7415, 57.16, 55.3681, 56.3224, 55.94, 55.8899, 56.3148, 58.9277, 59.5482, 57.6473, 57.6653, 56.452, 57.7433, 58.6105, 58.4152, 59.5461, 60.7044, 60.1321, 60.7766, 59.8878, 58.1958, 57.4981, 57.8565, 58.8337, 58.7867, 58.1441, 59.3038, 58.5958, 59.9163, 61.2009, 61.0644, 61.0394, 60.5522, 60.8011, 61.2419, 62.3867, 61.8464, 61.3559, 60.9168, 62.886, 63.1745, 62.9134, 63.2146, 63.872, 63.5301, 64.7669, 66.5272, 66.9034, 67.3689, 65.9471, 65.513, 67.2689, 67.4248, 66.6471, 67.04, 66.3188, 66.2026, 65.8183, 64.4627, 63.8444, 64.8199, 64.7539, 64.0176, 63.5747, 63.6499, 62.8432, 62.224, 61.5295, 60.123, 59.4817, 58.7867, 60.1488, 60.449, 62.3345, 61.8827, 61.965, 62.5773, 63.6177, 61.9805, 59.6771, 60.4637, 59.9791, 59.2245, 58.8344, 59.3511, 59.3732, 60.7072, 61.5123, 60.0114, 58.5588, 58.4954, 58.5095, 59.7549, 60.1231, 61.3212, 61.2276, 61.654, 59.8191, 59.8073, 59.9492, 60.6314, 60.7012, 61.1694, 60.6568, 59.7844, 60.6894, 59.6298, 58.5937, 58.2094, 59.5798, 57.1262, 57.2369, 56.9557, 56.9308, 58.2209, 60.112, 59.6852, 61.3485, 62.5404, 62.828, 64.3928, 63.7868, 63.4868, 61.6174, 63.115, 64.4021, 64.2672, 63.5157, 63.4133, 63.1277, 63.9687, 64.2688, 65.3738, 66.0545, 64.7868, 65.1667, 67.3773, 68.1809, 68.4805, 67.1927, 66.1022, 64.242, 65.1243, 66.7258, 66.0651, 64.9719, 63.7913, 64.6968, 63.6524, 64.8855, 65.2382, 66.2238, 66.7558, 65.4995, 65.2597, 65.0631, 63.6468, 62.8208, 62.6918, 65.2, 65.3603, 65.5238, 66.0281, 66.8658, 66.0551, 66.4241, 65.8072, 66.3885, 66.6358, 67.0932, 66.6705, 66.371, 66.4456, 66.2053, 66.1621, 65.5347, 64.5228, 64.9143, 65.5783, 64.9509, 65.4397, 65.1942, 65.955, 65.6368, 66.0039, 64.2276, 64.0921, 64.1034, 64.1856, 63.2327, 63.5891, 65.0999, 65.3748, 64.5321, 64.1466, 62.4015, 61.1144, 59.4482, 60.2765, 60.316, 57.6768, 57.8327, 58.3029, 59.2298, 59.9262, 60.1906, 59.3244, 62.0926, 61.4721, 61.7802, 60.8461, 60.2497, 59.009, 58.6377, 59.951, 57.5924, 58.087, 58.7154, 60.0706, 60.9267, 60.9901, 60.5036, 58.6636, 58.3071, 58.9689, 59.831, 58.8062, 60.1879, 59.4451, 59.7557, 60.0396, 60.6976, 59.3942, 58.827, 58.4609, 58.5305, 59.135, 58.2498, 59.1392, 58.2138, 57.7513, 58.2568, 58.4786, 58.3203, 56.7757, 56.9507, 57.6898, 57.81, 57.9485, 57.4415, 55.9711, 55.8937, 56.3389, 56.6287, 55.2286, 56.3618, 55.746, 54.5737, 54.0474, 54.1745, 53.9685, 53.3019, 53.958, 54.8801, 54.1971, 53.6441, 54.5625, 55.2876, 55.574, 54.6596, 54.3036, 53.2161, 53.9349, 53.282, 52.4237, 51.1158, 50.5023, 52.5062, 52.0478, 50.6357, 50.0018, 50.8321, 49.3592, 49.5094, 48.9229, 50.3548, 51.6159, 53.1046, 54.2763, 52.5437, 52.0777, 53.2304, 52.7328, 52.4236, 53.4092, 52.1756, 53.0833, 53.0439, 53.6626, 55.9569, 56.9763, 56.5409, 56.6382, 56.9339, 56.7542, 58.2707, 58.2128, 58.4712, 57.9963, 57.0161, 56.7704, 57.3175, 56.2747, 58.8495, 60.1463, 62.3036, 61.7442, 62.0678, 60.9232, 60.1752, 60.172, 60.2336, 59.7249, 60.009, 59.0916, 59.4538, 59.5065, 58.8729, 58.5179, 59.7707, 59.3342, 57.8227, 58.2169, 60.0279, 62.2191, 62.2189, 62.4351, 62.3517, 61.9777, 61.672, 61.6208, 61.8682, 60.5831, 59.9459, 58.021, 59.107, 59.4999, 59.9981, 60.2644, 59.9202, 59.6383, 59.742, 59.0286, 59.1893, 60.7098, 60.5192, 59.1038, 59.1585, 59.9667, 59.6403, 59.8743, 59.6506, 58.0097, 57.9087, 58.0075, 58.0351, 58.1936, 59.9722, 59.7011, 60.3712, 61.1308, 59.6791, 61.2128, 60.6413, 60.9451, 60.6429, 60.5575, 60.5063, 58.9744, 58.5757, 58.3398, 57.8219, 56.9415, 55.8264, 54.8314, 55.2254, 55.2875, 55.9252, 56.0096, 55.1201, 54.2506, 54.3968, 53.6367, 53.5976, 54.4454, 53.359, 53.6376, 53.132, 53.8323, 53.5386, 53.8046, 53.3853, 52.4028, 53.26, 53.6541, 53.0352, 53.6302, 54.5358, 55.2683, 56.0229, 57.3869, 57.0342, 56.4211, 56.1637, 59.1641, 59.2901, 59.9422, 59.5458, 59.8411, 60.46, 60.6291, 59.5297, 59.0578, 60.0593, 58.689, 58.7913, 59.5633, 60.1656, 60.6682, 60.4994, 60.6251, 59.7938, 59.9566, 60.5399, 59.7272, 60.3277, 59.9196, 60.155, 58.5112, 59.0298, 56.5908, 58.1008, 58.1154, 57.6483, 58.2381, 61.6445, 62.7142, 61.7502, 62.7002, 64.129, 62.3176, 61.9323, 61.3308, 62.0123, 61.4723, 60.9779, 60.104, 59.1123, 58.5916, 61.0361, 60.8002, 58.9606, 59.1318, 58.4501, 58.3336, 58.6351, 60.1049, 60.0784, 60.4673)
   println("mean:" +  data.sum/data.length)

    val render = Histogram(data).standard().xLabel("engines").render(plotAreaSize)
    val file = new java.io.File(s"FastTest-engine-test.png")
    render.write(file)
  }

  {

    val forcedXBounds = Bounds(-1, 3)

    def mkBins(values: Seq[Double], xbounds: Bounds, binCount: Int): Seq[Point] =
      Histogram.createBins(values, forcedXBounds, Histogram.defaultBinCount(values.size))

    def hist(xs:Seq[Double], c:Color) = 
      Histogram(xs, 
        // barRenderer = Some(BarRenderer.named( color = Some(c.opacity(0.5)))), 
        color = Some(c.opacity(0.5)),
        // binningFunction = mkBins,
        xbounds = Some(forcedXBounds)
      )

    
    val N = 1000
    // def data = Seq.fill(N)(Random.nextGaussian())// ++ List(-10d,10d) 
    def data = 1 to N map {_.toDouble/N}
    val hist1 = hist(data :+ 0.99d, HTMLNamedColors.dodgerBlue)
    val hist2 = hist(data :+ 2.0d, HTMLNamedColors.crimson)  //this is the test case that breaks overlay BAD!

    // val plot = hist1.standard()
    val plot = Overlay(hist1, hist2).standard()

    plot/*.xbounds(forcedXBounds)*/.render(plotAreaSize).write(new java.io.File(s"FastTest-overlay.png"))
  }
  

}

